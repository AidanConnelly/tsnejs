/*! @jwalsh/tsnejs - 0.1.0 */
!function(t){function r(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}var i={};return r.m=t,r.c=i,r.p="",r(0)}([function(t,r,i){window.tsnejs=i(1)},function(t,r){"use strict";var i=i||{REVISION:"ALPHA"};!function(t){function r(t){return t>0?1:t<0?-1:0}var i=function(t,r){if(!t)throw r||"Assertion failed"},n=function(t,r,i){return t.hasOwnProperty(r)?t[r]:i},s=!1,a=0,o=function t(){if(s)return s=!1,a;var r=2*Math.random()-1,i=2*Math.random()-1,n=r*r+i*i;if(0==n||n>1)return t();var o=Math.sqrt(-2*Math.log(n)/n);return a=i*o,s=!0,r*o},e=function(t,r){return t+o()*r},h=function(t){if("undefined"==typeof t||isNaN(t))return[];if("undefined"==typeof ArrayBuffer){for(var r=new Array(t),i=0;i<t;i++)r[i]=0;return r}return new Float64Array(t)},f=function(t,r,i){for(var n="undefined"!=typeof i,s=[],a=0;a<t;a++){for(var o=[],h=0;h<r;h++)n?o.push(i):o.push(e(0,1e-4));s.push(o)}return s},u=function(t,r){for(var i=t.length,n=0,s=0;s<i;s++){var a=t[s],o=r[s];n+=(a-o)*(a-o)}return n},v=function(t){for(var r=t.length,i=h(r*r),n=0;n<r;n++)for(var s=n+1;s<r;s++){var a=u(t[n],t[s]);i[n*r+s]=a,i[s*r+n]=a}return i},d=function(t,r,n){var s=Math.sqrt(t.length),a=Math.floor(s);i(a===s,"D should have square number of elements.");for(var o=Math.log(r),e=h(a*a),f=h(a),u=0;u<a;u++){for(var v=-(1/0),d=1/0,c=1,p=!1,l=50,m=0;!p;){for(var y=0,g=0;g<a;g++){var Y=Math.exp(-t[u*a+g]*c);u===g&&(Y=0),f[g]=Y,y+=Y}for(var x=0,g=0;g<a;g++){if(0==y)var Y=0;else var Y=f[g]/y;f[g]=Y,Y>1e-7&&(x-=Y*Math.log(Y))}x>o?(v=c,d===1/0?c*=2:c=(c+d)/2):(d=c,v===-(1/0)?c/=2:c=(c+v)/2),m++,Math.abs(x-o)<n&&(p=!0),m>=l&&(p=!0)}for(var g=0;g<a;g++)e[u*a+g]=f[g]}for(var M=h(a*a),N=2*a,u=0;u<a;u++)for(var g=0;g<a;g++)M[u*a+g]=Math.max((e[u*a+g]+e[g*a+u])/N,1e-100);return M},c=function(t){var t=t||{};this.perplexity=n(t,"perplexity",30),this.dim=n(t,"dim",2),this.epsilon=n(t,"epsilon",10),this.iter=0};c.prototype={initDataRaw:function(t){var r=t.length,n=t[0].length;i(r>0," X is empty? You must have some data!"),i(n>0," X[0] is empty? Where is the data?");var s=v(t);this.P=d(s,this.perplexity,1e-4),this.N=r,this.initSolution()},initDataDist:function(t){var r=t.length;i(r>0," X is empty? You must have some data!");for(var n=h(r*r),s=0;s<r;s++)for(var a=s+1;a<r;a++){var o=t[s][a];n[s*r+a]=o,n[a*r+s]=o}this.P=d(n,this.perplexity,1e-4),this.N=r,this.initSolution()},initSolution:function(){this.Y=f(this.N,this.dim),this.gains=f(this.N,this.dim,1),this.ystep=f(this.N,this.dim,0),this.iter=0},getSolution:function(){return this.Y},step:function(){this.iter+=1;for(var t=this.N,i=this.costGrad(this.Y),n=i.cost,s=i.grad,a=h(this.dim),o=0;o<t;o++)for(var e=0;e<this.dim;e++){var f=s[o][e],u=this.ystep[o][e],v=this.gains[o][e],d=r(f)===r(u)?.8*v:v+.2;d<.01&&(d=.01),this.gains[o][e]=d;var c=this.iter<250?.5:.8,p=c*u-this.epsilon*d*s[o][e];this.ystep[o][e]=p,this.Y[o][e]+=p,a[e]+=this.Y[o][e]}for(var o=0;o<t;o++)for(var e=0;e<this.dim;e++)this.Y[o][e]-=a[e]/t;return n},debugGrad:function(){for(var t=this.N,r=this.costGrad(this.Y),i=(r.cost,r.grad),n=1e-5,s=0;s<t;s++)for(var a=0;a<this.dim;a++){var o=this.Y[s][a];this.Y[s][a]=o+n;var e=this.costGrad(this.Y);this.Y[s][a]=o-n;var h=this.costGrad(this.Y),f=i[s][a],u=(e.cost-h.cost)/(2*n);console.log(s+","+a+": gradcheck analytic: "+f+" vs. numerical: "+u),this.Y[s][a]=o}},costGrad:function(t){for(var r=this.N,i=this.dim,n=this.P,s=this.iter<100?4:1,a=h(r*r),o=0,e=0;e<r;e++)for(var f=e+1;f<r;f++){for(var u=0,v=0;v<i;v++){var d=t[e][v]-t[f][v];u+=d*d}var c=1/(1+u);a[e*r+f]=c,a[f*r+e]=c,o+=2*c}for(var p=r*r,l=h(p),m=0;m<p;m++)l[m]=Math.max(a[m]/o,1e-100);for(var y=0,g=[],e=0;e<r;e++){for(var Y=new Array(i),v=0;v<i;v++)Y[v]=0;for(var f=0;f<r;f++){y+=-n[e*r+f]*Math.log(l[e*r+f]);for(var x=4*(s*n[e*r+f]-l[e*r+f])*a[e*r+f],v=0;v<i;v++)Y[v]+=x*(t[e][v]-t[f][v])}g.push(Y)}return{cost:y,grad:g}}},t.tSNE=c}(i),function(r){"undefined"==typeof t||"undefined"==typeof t.exports?window.tsnejs=r:t.exports=r}(i)}]);
//# sourceMappingURL=bundle.min.js.map